<?xml version="1.0" encoding="UTF-8"?>
<!DOCTYPE mapper PUBLIC "-//mybatis.org//DTD Mapper 3.0//EN" "http://mybatis.org/dtd/mybatis-3-mapper.dtd">
<mapper namespace="cn.com.eship.repository.EnterpriseTypeMapper">
  <resultMap id="BaseResultMap" type="cn.com.eship.models.EnterpriseType">
    <!--
      WARNING - @mbggenerated
      This element is automatically generated by MyBatis Generator, do not modify.
    -->
    <result column="QYSL" jdbcType="VARCHAR" property="qysl" />
    <result column="LX" jdbcType="VARCHAR" property="lx" />
  </resultMap>
  <sql id="Base_Column_List">
    <!--
      WARNING - @mbggenerated
      This element is automatically generated by MyBatis Generator, do not modify.
    -->
    QYSL, LX
  </sql>
<select id="selectEnterpriseType" resultMap="BaseResultMap">
select b.CNAME lx,a.qysl from
(select count(ENT_INFO_ID) qysl,ENT_NATURE_NAME qyxz
from  eciq_gdata.ITF_ENT_BASE_INFO
where ENT_NATURE_NAME is not null
group by ENT_NATURE_NAME  order by count(distinct ENT_INFO_ID) desc) a
left join eciq_gdata.Z_CCM_SIMPLELIST_2 b
on a.qyxz = b.CODE where b.INDEXID = 'CorporationCharacter'

</select>

  <select id="selectQyzsl" resultType="Integer">
    select count(ENT_INFO_ID) from
    eciq_gdata.ITF_ENT_BASE_INFO
    where ENT_NATURE_NAME is not null and VALID_FLAG = 1
  </select>
</mapper>