<?xml version="1.0" encoding="UTF-8" ?>
<!DOCTYPE mapper PUBLIC "-//mybatis.org//DTD Mapper 3.0//EN" "http://mybatis.org/dtd/mybatis-3-mapper.dtd" >
<mapper namespace="cn.com.eship.repository.DangqianxinyongMapper" >
    <resultMap id="BaseResultMap" type="cn.com.eship.models.Dangqianxinyongxinxi">
        <!--
          WARNING - @mbggenerated
          This element is automatically generated by MyBatis Generator, do not modify.
        -->
        <result column="ZZJGDM" jdbcType="VARCHAR" property="zzjgdm" />
        <result column="QYMC" jdbcType="VARCHAR" property="qymc" />
        <result column="QYZCH" jdbcType="VARCHAR" property="qyzch" />
        <result column="QYDZ" jdbcType="VARCHAR" property="qydz" />
        <result column="QYDH" jdbcType="VARCHAR" property="qydh" />
        <result column="LXR" jdbcType="VARCHAR" property="lxr" />
        <result column="CPFW" jdbcType="VARCHAR" property="cpfw" />
        <result column="ZGJG1" jdbcType="VARCHAR" property="zgjg1" />
        <result column="ZGBM1" jdbcType="VARCHAR" property="zgbm1" />
        <result column="ZGJG2" jdbcType="VARCHAR" property="zgjg2" />
        <result column="ZGBM2" jdbcType="VARCHAR" property="zgbm2" />
        <result column="DQXYJB" jdbcType="VARCHAR" property="dqxyjb" />
        <result column="DQXYFZ" jdbcType="VARCHAR" property="dqxyfz" />
        <result column="QYLX" jdbcType="VARCHAR" property="qylx" />
        <result column="BJPC" jdbcType="INTEGER" property="bjpc" />
    </resultMap>
    <sql id="Base_Column_List">
        <!--
          WARNING - @mbggenerated
          This element is automatically generated by MyBatis Generator, do not modify.
        -->
        ZZJGDM, QYMC, QYZCH,QYDZ,QYDH,LXR,CPFW,ZGJG1,ZGBM1,ZGJG2,ZGBM2,DQXYJB,DQXYFZ,QYLX
    </sql>
    <select id="selectDangqianxinyong" resultMap="BaseResultMap">
select a.zzjgdm,a.qymc,a.dqxyfz,a.dqxyjb,c.bjpc,a.gdsj
from (select count(b.ywglh) bjpc,b.zzjgdm zzjgdm
from ESHIP_LIQ.LISHIXINYONGXINXIXIANGQING b group by b.zzjgdm) c
left join  ESHIP_LIQ.LISHIXINYONGXINXI a
on c.zzjgdm=a.zzjgdm
where a.dqxyjb !='0'  and a.gdsj >= add_months(trunc(sysdate,'YYYY'),-12)
    </select>
    <select id="selectZaianqiye" resultType="Integer">
select count(distinct ENT_INFO_ID)
 from   eciq_gdata.ITF_ENT_BASE_INFO
 where VALID_FLAG = 1
    </select>
    <select id="selectBaojianqiye" resultType="Integer">
select count(distinct DECL_REG_NO)
from   eciq_gdata.ITF_DCL_IO_DECL
    </select>
    <select id="selectJinkoushouhuoqiye" resultType="Integer">
select count(distinct CONSIGNEE_CODE)
from   eciq_gdata.ITF_DCL_IO_DECL
    </select>
    <select id="selectChukoufahuoqiye" resultType="Integer">
select count(distinct CONSIGNOR_CODE)
from  eciq_gdata.ITF_DCL_IO_DECL
    </select>
    <select id="selectChukoushengchanqiye" resultType="Integer">
select count(distinct MNUFCTR_CODE)
from  eciq_gdata.ITF_INS_RESULT_GOODS
    </select>

    <select id="selectBYBaojiandan" resultType="Integer">
        select count(distinct DECL_NO) from
        eciq_gdata.ITF_DCL_IO_DECL  where
        DECL_DATE between TRUNC(SYSDATE, 'MM')  and last_day(SYSDATE)
    </select>
    <select id="selectBYBaojianjine" resultType="Long">
        select sum(TOTAL_VAL_CN) from
        eciq_gdata.ITF_DCL_IO_DECL  where
        DECL_DATE between TRUNC(SYSDATE, 'MM')  and last_day(SYSDATE)
    </select>
    <select id="selectBYBaojianqiye" resultType="Integer">
        select count(distinct DECL_REG_NO) from
        eciq_gdata.ITF_DCL_IO_DECL  where
        DECL_DATE between TRUNC(SYSDATE, 'MM')  and last_day(SYSDATE)
    </select>
    <select id="selectBjjeBy" resultType="Long">
        select sum(TOTAL_VAL_CN) from
        eciq_gdata.ITF_DCL_IO_DECL  where
        DECL_DATE between TRUNC(SYSDATE, 'MM')  and last_day(SYSDATE)
    </select>
    <select id="selectBjjeSy" resultType="Long">
        select sum(TOTAL_VAL_CN) from
        eciq_gdata.ITF_DCL_IO_DECL  where
        DECL_DATE BETWEEN last_day(add_months(sysdate,-2))+1 and last_day(add_months(sysdate,-1))
    </select>
    <select id="selectBYbuhegepici" resultType="Integer">
        select count(distinct b.DECL_NO) from
        eciq_gdata.ITF_DCL_IO_DECL b where
        b.DECL_DATE between TRUNC(SYSDATE, 'MM')  and last_day(SYSDATE)
        and b.DECL_NO in (select distinct a.DECL_NO from
        eciq_gdata.ITF_INS_RESULT_GOODS a where a.DISQUA_CONT_CODES is not null)
    </select>
    <select id="selectBYbuhegejine" resultType="Long">
        select sum(b.TOTAL_VAL_CN) from
        eciq_gdata.ITF_DCL_IO_DECL b where
        b.DECL_DATE between TRUNC(SYSDATE, 'MM')  and last_day(SYSDATE)
        and b.DECL_NO in (select distinct a.DECL_NO from
        eciq_gdata.ITF_INS_RESULT_GOODS a where a.DISQUA_CONT_CODES is not null)
    </select>
</mapper>