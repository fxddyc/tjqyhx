<?xml version="1.0" encoding="UTF-8" ?>
<!DOCTYPE mapper PUBLIC "-//mybatis.org//DTD Mapper 3.0//EN" "http://mybatis.org/dtd/mybatis-3-mapper.dtd" >
<mapper namespace="cn.com.eship.repository.HolographicPortraitMapper" >
    <resultMap id="BaseResultMap" type="cn.com.eship.models.ItfInsResultGoods">
        <!--
          WARNING - @mbggenerated
          This element is automatically generated by MyBatis Generator, do not modify.
        -->
         <result column="RMB" jdbcType="VARCHAR" property="rmb" />
         <result column="BJPC" jdbcType="VARCHAR" property="bjpc" />
         <result column="QYSM" jdbcType="VARCHAR" property="qysm" />
         <result column="DM" jdbcType="VARCHAR" property="dm" />
         <result column="CNAME" jdbcType="VARCHAR" property="cname" />
    </resultMap>
    <sql id="Base_Column_List">
        <!--
          WARNING - @mbggenerated
          This element is automatically generated by MyBatis Generator, do not modify.
        -->
               RMB,BJPC,QYSM,DM
    </sql>
    <select id="selectJYanRmb" resultMap="BaseResultMap">
  select c.CNAME,d.rmb,d.dm from
(select sum(DISQUA_AMT_RMB) rmb,substr(DISQUA_CONT_CODES,1,2) dm
from eciq_gdata.ITF_INS_RESULT_GOODS
where  substr(DISQUA_CONT_CODES,1,2) in ('11','12','21','22','31','32','33','41','42','51')
and INS_OPERT_DATE between TRUNC(SYSDATE, 'MM')  and last_day(SYSDATE)
group by substr(DISQUA_CONT_CODES,1,2)) d left join eciq_gdata.Z_CCM_SIMPLELIST_7 c on d.dm = c.CODE
    </select>

    <select id="selectJYiRmb1" resultMap="BaseResultMap">
  select c.CNAME,d.rmb,d.dm from
(select sum(DISQUA_AMT_RMB) rmb,substr(DISQUA_CONT_CODES,4,2) dm
from eciq_gdata.ITF_INS_RESULT_GOODS
where   substr(DISQUA_CONT_CODES,4,2) in ('61','62','63','69','99')
and QUAR_CONDT_TIME between TRUNC(SYSDATE, 'MM')  and last_day(SYSDATE)
group by substr(DISQUA_CONT_CODES,4,2)) d left join eciq_gdata.Z_CCM_SIMPLELIST_7 c on d.dm = c.CODE
    </select>
    <select id="selectJYiRmb2" resultMap="BaseResultMap">
 select c.CNAME,d.rmb,d.dm from
(select sum(DISQUA_AMT_RMB) rmb, DISQUA_CONT_CODES dm
from eciq_gdata.ITF_INS_RESULT_GOODS
where  DISQUA_CONT_CODES in ('61','62','63','69','99')
and QUAR_CONDT_TIME between TRUNC(SYSDATE, 'MM')  and last_day(SYSDATE)
group by DISQUA_CONT_CODES)  d left join eciq_gdata.Z_CCM_SIMPLELIST_7 c on d.dm = c.CODE
    </select>
    <select id="selectJYanBjpc" resultMap="BaseResultMap">
 select c.CNAME,d.bjpc,d.dm from
(select substr(DISQUA_CONT_CODES,1,2) dm,count(distinct DECL_NO) bjpc
from eciq_gdata.ITF_INS_RESULT_GOODS
where  substr(DISQUA_CONT_CODES,1,2) in ('11','12','21','22','31','32','33','41','42','51')
and INS_OPERT_DATE between TRUNC(SYSDATE, 'MM')  and last_day(SYSDATE)
group by substr(DISQUA_CONT_CODES,1,2)) d left join eciq_gdata.Z_CCM_SIMPLELIST_7 c on d.dm = c.CODE
    </select>
    <select id="selectJYiBjpc1" resultMap="BaseResultMap">
select c.CNAME,d.bjpc,d.dm from
(select count(distinct DECL_NO) bjpc,substr(DISQUA_CONT_CODES,4,2) dm
from eciq_gdata.ITF_INS_RESULT_GOODS
where  substr(DISQUA_CONT_CODES,4,2) in ('61','62','63','69','99')
and QUAR_CONDT_TIME  between TRUNC(SYSDATE, 'MM')  and last_day(SYSDATE)
group by substr(DISQUA_CONT_CODES,4,2)) d left join eciq_gdata.Z_CCM_SIMPLELIST_7 c on d.dm = c.CODE
    </select>
    <select id="selectJYiBjpc2" resultMap="BaseResultMap">
select c.CNAME,d.bjpc,d.dm from
(select count(distinct DECL_NO) bjpc, DISQUA_CONT_CODES dm
from eciq_gdata.ITF_INS_RESULT_GOODS
where  DISQUA_CONT_CODES in ('61','62','63','69','99')
and QUAR_CONDT_TIME  between TRUNC(SYSDATE, 'MM')  and last_day(SYSDATE)
group by DISQUA_CONT_CODES) d left join eciq_gdata.Z_CCM_SIMPLELIST_7 c on d.dm = c.CODE
    </select>
    <select id="selectJYanQysm" resultMap="BaseResultMap">
   select c.CNAME,d.qysm,d.dm from
(select count(distinct a.DECL_REG_NO) qysm,substr(b.DISQUA_CONT_CODES,1,2) dm
from eciq_gdata.ITF_INS_RESULT_GOODS b
left join eciq_gdata.ITF_DCL_IO_DECL a on a.DECL_NO=b.DECL_NO
where substr(b.DISQUA_CONT_CODES,1,2) in ('11','12','21','22','31','32','33','41','42','51')
and a.DECL_DATE between TRUNC(SYSDATE, 'MM')  and last_day(SYSDATE)
group by substr(b.DISQUA_CONT_CODES,1,2)) d left join eciq_gdata.Z_CCM_SIMPLELIST_7 c on d.dm = c.CODE
    </select>
    <select id="selectJYiQysm1" resultMap="BaseResultMap">
 select c.CNAME,d.qysm,d.dm from
(select count(distinct a.DECL_REG_NO) qysm, substr(b.DISQUA_CONT_CODES,4,2) dm
from eciq_gdata.ITF_INS_RESULT_GOODS b
left join eciq_gdata.ITF_DCL_IO_DECL a on a.DECL_NO=b.DECL_NO
where substr(b.DISQUA_CONT_CODES,4,2) in ('61','62','63','69','99')
and a.DECL_DATE between TRUNC(SYSDATE, 'MM')  and last_day(SYSDATE)
group by substr(b.DISQUA_CONT_CODES,4,2)) d left join eciq_gdata.Z_CCM_SIMPLELIST_7  c on d.dm = c.CODE
    </select>
    <select id="selectJYiQysm2" resultMap="BaseResultMap">
  select c.CNAME,d.qysm,d.dm from
(select count(distinct a.DECL_REG_NO) qysm,b.DISQUA_CONT_CODES dm
from eciq_gdata.ITF_INS_RESULT_GOODS b
left join eciq_gdata.ITF_DCL_IO_DECL a on b.DECL_NO =a.DECL_NO
where  b.DISQUA_CONT_CODES in ('61','62','63','69','99')
and a.DECL_DATE between TRUNC(SYSDATE, 'MM')  and last_day(SYSDATE)
group by  b.DISQUA_CONT_CODES)  d left join eciq_gdata.Z_CCM_SIMPLELIST_7 c on d.dm = c.CODE
    </select>

    <select id="selectDyfb" resultMap="BaseResultMap">
        select count(distinct DECL_REG_NO) qysm,substr(DECL_REG_NO,1,2) dm from
        eciq_gdata.ITF_DCL_IO_DECL
        where  DECL_DATE between TRUNC(SYSDATE, 'MM')
        and last_day(SYSDATE)  group by substr(DECL_REG_NO,1,2)
        order by count(distinct DECL_REG_NO) desc
    </select>

</mapper>